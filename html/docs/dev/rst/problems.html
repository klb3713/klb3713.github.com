
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Problems With StructuredText &mdash; klb3713&#39;s notebook</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="klb3713&#39;s notebook" href="../../../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="../../../index.html">klb3713&#39;s notebook</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="problems-with-structuredtext">
<h1><a class="toc-backref" href="#id3">Problems With StructuredText</a><a class="headerlink" href="#problems-with-structuredtext" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">David Goodger</td>
</tr>
<tr class="field-even field"><th class="field-name">Contact:</th><td class="field-body"><a class="reference external" href="mailto:docutils-develop&#37;&#52;&#48;lists&#46;sourceforge&#46;net">docutils-develop<span>&#64;</span>lists<span>&#46;</span>sourceforge<span>&#46;</span>net</a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Revision:</th><td class="field-body">$Revision: 7302 $</td>
</tr>
<tr class="field-even field"><th class="field-name">Date:</th><td class="field-body">$Date: 2012-01-03 20:23:53 +0100 (Di, 03. Jan 2012) $</td>
</tr>
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">This document has been placed in the public domain.</td>
</tr>
</tbody>
</table>
<p>There are several problems, unresolved issues, and areas of
controversy within <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a> (Classic and Next Generation).  In
order to resolve all these issues, this analysis brings all of the
issues out into the open, enumerates all the alternatives, and
proposes solutions to be incorporated into the <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a>
specification.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#problems-with-structuredtext" id="id3">Problems With StructuredText</a><ul>
<li><a class="reference internal" href="#formal-specification" id="id4">Formal Specification</a></li>
<li><a class="reference internal" href="#understanding-and-extending-the-code" id="id5">Understanding and Extending the Code</a></li>
<li><a class="reference internal" href="#section-structure-via-indentation" id="id6">Section Structure via Indentation</a></li>
<li><a class="reference internal" href="#character-escaping-mechanism" id="id7">Character Escaping Mechanism</a></li>
<li><a class="reference internal" href="#blank-lines-in-lists" id="id8">Blank Lines in Lists</a></li>
<li><a class="reference internal" href="#bullet-list-markup" id="id9">Bullet List Markup</a></li>
<li><a class="reference internal" href="#enumerated-list-markup" id="id10">Enumerated List Markup</a></li>
<li><a class="reference internal" href="#definition-list-markup" id="id11">Definition List Markup</a></li>
<li><a class="reference internal" href="#literal-blocks" id="id12">Literal Blocks</a></li>
<li><a class="reference internal" href="#tables" id="id13">Tables</a></li>
<li><a class="reference internal" href="#delimitation-of-inline-markup" id="id14">Delimitation of Inline Markup</a></li>
<li><a class="reference internal" href="#underlining" id="id15">Underlining</a></li>
<li><a class="reference internal" href="#inline-literals" id="id16">Inline Literals</a></li>
<li><a class="reference internal" href="#hyperlinks" id="id17">Hyperlinks</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="formal-specification">
<h2><a class="toc-backref" href="#id4">Formal Specification</a><a class="headerlink" href="#formal-specification" title="Permalink to this headline">¶</a></h2>
<p>The description in the original StructuredText.py has been criticized
for being vague.  For practical purposes, &#8220;the code <em>is</em> the spec.&#8221;
Tony Ibbs has been working on deducing a <a class="reference external" href="http://homepage.ntlworld.com/tibsnjoan/docutils/STNG-format.html">detailed description</a> from
the documentation and code of <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/StructuredTextNG">StructuredTextNG</a>.  Edward Loper&#8217;s
<a class="reference external" href="http://www.cis.upenn.edu/~edloper/pydoc/stminus.html">STMinus</a> is another attempt to formalize a spec.</p>
<p>For this kind of a project, the specification should always precede
the code.  Otherwise, the markup is a moving target which can never be
adopted as a standard.  Of course, a specification may be revised
during lifetime of the code, but without a spec there is no visible
control and thus no confidence.</p>
</div>
<div class="section" id="understanding-and-extending-the-code">
<h2><a class="toc-backref" href="#id5">Understanding and Extending the Code</a><a class="headerlink" href="#understanding-and-extending-the-code" title="Permalink to this headline">¶</a></h2>
<p>The original <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a> is a dense mass of sparsely commented
code and inscrutable regular expressions.  It was not designed to be
extended and is very difficult to understand.  <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/StructuredTextNG">StructuredTextNG</a> has
been designed to allow input (syntax) and output extensions, but its
documentation (both internal [comments &amp; docstrings], and external) is
inadequate for the complexity of the code itself.</p>
<p>For reStructuredText to become truly useful, perhaps even part of
Python&#8217;s standard library, it must have clear, understandable
documentation and implementation code.  For the implementation of
reStructuredText to be taken seriously, it must be a sterling example
of the potential of docstrings; the implementation must practice what
the specification preaches.</p>
</div>
<div class="section" id="section-structure-via-indentation">
<h2><a class="toc-backref" href="#id6">Section Structure via Indentation</a><a class="headerlink" href="#section-structure-via-indentation" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://docutils.sourceforge.net/mirror/setext.html">Setext</a> required that body text be indented by 2 spaces.  The original
<a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a> and <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/StructuredTextNG">StructuredTextNG</a> require that section structure
be indicated through indentation, as &#8220;inspired by Python&#8221;.  For
certain structures with a very limited, local extent (such as lists,
block quotes, and literal blocks), indentation naturally indicates
structure or hierarchy.  For sections (which may have a very large
extent), structure via indentation is unnecessary, unnatural and
ambiguous.  Rather, the syntax of the section title <em>itself</em> should
indicate that it is a section title.</p>
<p>The original StructuredText states that &#8220;A single-line paragraph whose
immediately succeeding paragraphs are lower level is treated as a
header.&#8221; Requiring indentation in this way is:</p>
<ul class="simple">
<li>Unnecessary.  The vast majority of docstrings and standalone
documents will have no more than one level of section structure.
Requiring indentation for such docstrings is unnecessary and
irritating.</li>
<li>Unnatural.  Most published works use title style (type size, face,
weight, and position) and/or section/subsection numbering rather
than indentation to indicate hierarchy.  This is a tradition with a
very long history.</li>
<li>Ambiguous.  A StructuredText header is indistinguishable from a
one-line paragraph followed by a block quote (precluding the use of
block quotes).  Enumerated section titles are ambiguous (is it a
header? is it a list item?).  Some additional adornment must be
required to confirm the line&#8217;s role as a title, both to a parser and
to the human reader of the source text.</li>
</ul>
<p>Python&#8217;s use of significant whitespace is a wonderful (if not
original) innovation, however requiring indentation in ordinary
written text is hypergeneralization.</p>
<p><a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> indicates section structure through title adornment
style (as exemplified by this document).  This is far more natural.
In fact, it is already in widespread use in plain text documents,
including in Python&#8217;s standard distribution (such as the toplevel
<a class="reference external" href="http://cvs.sourceforge.net/cgi-bin/viewcvs.cgi/~checkout~/python/python/dist/src/README">README</a> file).</p>
</div>
<div class="section" id="character-escaping-mechanism">
<h2><a class="toc-backref" href="#id7">Character Escaping Mechanism</a><a class="headerlink" href="#character-escaping-mechanism" title="Permalink to this headline">¶</a></h2>
<p>No matter what characters are chosen for markup, some day someone will
want to write documentation <em>about</em> that markup or using markup
characters in a non-markup context.  Therefore, any complete markup
language must have an escaping or encoding mechanism.  For a
lightweight markup system, encoding mechanisms like SGML/XML&#8217;s &#8216;&amp;ast;&#8217;
are out.  So an escaping mechanism is in.  However, with carefully
chosen markup, it should be necessary to use the escaping mechanism
only infrequently.</p>
<p><a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> needs an escaping mechanism: a way to treat
markup-significant characters as the characters themselves.  Currently
there is no such mechanism (although ZWiki uses &#8216;!&#8217;).  What are the
candidates?</p>
<ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">!</span></tt>
(<a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/NGEscaping">http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/NGEscaping</a>)</li>
<li><tt class="docutils literal"><span class="pre">\</span></tt></li>
<li><tt class="docutils literal"><span class="pre">~</span></tt></li>
<li>doubling of characters</li>
</ol>
<p>The best choice for this is the backslash (<tt class="docutils literal"><span class="pre">\</span></tt>).  It&#8217;s &#8220;the single
most popular escaping character in the world!&#8221;, therefore familiar and
unsurprising.  Since characters only need to be escaped under special
circumstances, which are typically those explaining technical
programming issues, the use of the backslash is natural and
understandable.  Python docstrings can be raw (prefixed with an &#8216;r&#8217;,
as in &#8216;r&#8221;&#8220;&#8217;), which would obviate the need for gratuitous doubling-up
of backslashes.</p>
<p>(On 2001-03-29 on the Doc-SIG mailing list, GvR endorsed backslash
escapes, saying, &#8220;&#8216;nuff said.  Backslash it is.&#8221; Although neither
legally binding nor irrevocable nor any kind of guarantee of anything,
it is a good sign.)</p>
<p>The rule would be: An unescaped backslash followed by any markup
character escapes the character.  The escaped character represents the
character itself, and is prevented from playing a role in any markup
interpretation.  The backslash is removed from the output.  A literal
backslash is represented by an &#8220;escaped backslash,&#8221; two backslashes in
a row.</p>
<p>A carefully constructed set of recognition rules for inline markup
will obviate the need for backslash-escapes in almost all cases; see
<a class="reference internal" href="#delimitation-of-inline-markup">Delimitation of Inline Markup</a> below.</p>
<p>When an expression (requiring backslashes and other characters used
for markup) becomes too complicated and therefore unreadable, a
literal block may be used instead.  Inside literal blocks, no markup
is recognized, therefore backslashes (for the purpose of escaping
markup) become unnecessary.</p>
<p>We could allow backslashes preceding non-markup characters to remain
in the output.  This would make describing regular expressions and
other uses of backslashes easier.  However, this would complicate the
markup rules and would be confusing.</p>
</div>
<div class="section" id="blank-lines-in-lists">
<h2><a class="toc-backref" href="#id8">Blank Lines in Lists</a><a class="headerlink" href="#blank-lines-in-lists" title="Permalink to this headline">¶</a></h2>
<p>Oft-requested in Doc-SIG (the earliest reference is dated 1996-08-13)
is the ability to write lists without requiring blank lines between
items.  In docstrings, space is at a premium.  Authors want to convey
their API or usage information in as compact a form as possible.
<a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a> requires blank lines between all body elements,
including list items, even when boundaries are obvious from the markup
itself.</p>
<p>In reStructuredText, blank lines are optional between list items.
However, in order to eliminate ambiguity, a blank line is required
before the first list item and after the last.  Nested lists also
require blank lines before the list start and after the list end.</p>
</div>
<div class="section" id="bullet-list-markup">
<h2><a class="toc-backref" href="#id9">Bullet List Markup</a><a class="headerlink" href="#bullet-list-markup" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a> includes &#8216;o&#8217; as a bullet character.  This is dangerous
and counter to the language-independent nature of the markup.  There
are many languages in which &#8216;o&#8217; is a word.  For example, in Spanish:</p>
<div class="highlight-python"><pre>Llamame a la casa
o al trabajo.

(Call me at home or at work.)</pre>
</div>
<p>And in Japanese (when romanized):</p>
<div class="highlight-python"><pre>Senshuu no doyoubi ni tegami
o kakimashita.

([I] wrote a letter on Saturday last week.)</pre>
</div>
<p>If a paragraph containing an &#8216;o&#8217; word wraps such that the &#8216;o&#8217; is the
first text on a line, or if a paragraph begins with such a word, it
could be misinterpreted as a bullet list.</p>
<p>In <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a>, &#8216;o&#8217; is not used as a bullet character.  &#8216;-&#8216;,
&#8216;*&#8217;, and &#8216;+&#8217; are the possible bullet characters.</p>
</div>
<div class="section" id="enumerated-list-markup">
<h2><a class="toc-backref" href="#id10">Enumerated List Markup</a><a class="headerlink" href="#enumerated-list-markup" title="Permalink to this headline">¶</a></h2>
<p>StructuredText enumerated lists are allowed to begin with numbers and
letters followed by a period or right-parenthesis, then whitespace.
This has surprising consequences for writing styles.  For example,
this is recognized as an enumerated list item by StructuredText:</p>
<div class="highlight-python"><pre>Mr. Creosote.</pre>
</div>
<p>People will write enumerated lists in all different ways.  It is folly
to try to come up with the &#8220;perfect&#8221; format for an enumerated list,
and limit the docstring parser&#8217;s recognition to that one format only.</p>
<p>Rather, the parser should recognize a variety of enumerator styles.
It is also recommended that the enumerator of the first list item be
ordinal-1 (&#8216;1&#8217;, &#8216;A&#8217;, &#8216;a&#8217;, &#8216;I&#8217;, or &#8216;i&#8217;), as output formats may not be
able to begin a list at an arbitrary enumeration.</p>
<p>An initial idea was to require two or more consistent enumerated list
items in a row.  This idea proved impractical and was dropped.  In
practice, the presence of a proper enumerator is enough to reliably
recognize an enumerated list item; any ambiguities are reported by the
parser.  Here&#8217;s the original idea for posterity:</p>
<blockquote>
<div><p>The parser should recognize a variety of enumerator styles, mark
each block as a potential enumerated list item (PELI), and
interpret the enumerators of adjacent PELIs to decide whether they
make up a consistent enumerated list.</p>
<p>If a PELI is labeled with a &#8220;1.&#8221;, and is immediately followed by a
PELI labeled with a &#8220;2.&#8221;, we&#8217;ve got an enumerated list.  Or &#8220;(A)&#8221;
followed by &#8220;(B)&#8221;.  Or &#8220;i)&#8221; followed by &#8220;ii)&#8221;, etc.  The chances
of accidentally recognizing two adjacent and consistently labeled
PELIs, are acceptably small.</p>
<p>For an enumerated list to be recognized, the following must be
true:</p>
<ul class="simple">
<li>the list must consist of multiple adjacent list items (2 or
more)</li>
<li>the enumerators must all have the same format</li>
<li>the enumerators must be sequential</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="definition-list-markup">
<h2><a class="toc-backref" href="#id11">Definition List Markup</a><a class="headerlink" href="#definition-list-markup" title="Permalink to this headline">¶</a></h2>
<p>StructuredText uses &#8216; &#8211; &#8216; (whitespace, two hyphens, whitespace) on
the first line of a paragraph to indicate a definition list item.  The
&#8216; &#8211; &#8216; serves to separate the term (on the left) from the definition
(on the right).</p>
<p>Many people use &#8216; &#8211; &#8216; as an em-dash in their text, conflicting with
the StructuredText usage.  Although the Chicago Manual of Style says
that spaces should not be used around an em-dash, Peter Funk pointed
out that this is standard usage in German (according to the Duden, the
official German reference), and possibly in other languages as well.
The widespread use of &#8216; &#8211; &#8216; precludes its use for definition lists;
it would violate the &#8220;unsurprising&#8221; criterion.</p>
<p>A simpler, and at least equally visually distinctive construct
(proposed by Guido van Rossum, who incidentally is a frequent user of
&#8216; &#8211; &#8216;) would do just as well:</p>
<div class="highlight-python"><pre>term 1
    Definition.

term 2
    Definition 2, paragraph 1.

    Definition 2, paragraph 2.</pre>
</div>
<p>A reStructuredText definition list item consists of a term and a
definition.  A term is a simple one-line paragraph.  A definition is a
block indented relative to the term, and may contain multiple
paragraphs and other body elements.  No blank line precedes a
definition (this distinguishes definition lists from block quotes).</p>
</div>
<div class="section" id="literal-blocks">
<h2><a class="toc-backref" href="#id12">Literal Blocks</a><a class="headerlink" href="#literal-blocks" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a> specification has literal blocks indicated by
&#8216;example&#8217;, &#8216;examples&#8217;, or &#8216;::&#8217; ending the preceding paragraph.  STNG
only recognizes &#8216;::&#8217;; &#8216;example&#8217;/&#8217;examples&#8217; are not implemented.  This
is good; it fixes an unnecessary language dependency.  The problem is
what to do with the sometimes- unwanted &#8216;::&#8217;.</p>
<p>In <a class="reference external" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> &#8216;::&#8217; at the end of a paragraph indicates that
subsequent <em>indented</em> blocks are treated as literal text.  No further
markup interpretation is done within literal blocks (not even
backslash-escapes).  If the &#8216;::&#8217; is preceded by whitespace, &#8216;::&#8217; is
omitted from the output; if &#8216;::&#8217; was the sole content of a paragraph,
the entire paragraph is removed (no &#8216;empty&#8217; paragraph remains).  If
&#8216;::&#8217; is preceded by a non-whitespace character, &#8216;::&#8217; is replaced by
&#8216;:&#8217; (i.e., the extra colon is removed).</p>
<p>Thus, a section could begin with a literal block as follows:</p>
<div class="highlight-python"><pre>Section Title
-------------

::

    print "this is example literal"</pre>
</div>
</div>
<div class="section" id="tables">
<h2><a class="toc-backref" href="#id13">Tables</a><a class="headerlink" href="#tables" title="Permalink to this headline">¶</a></h2>
<p>The table markup scheme in classic StructuredText was horrible.  Its
omission from StructuredTextNG is welcome, and its markup will not be
repeated here.  However, tables themselves are useful in
documentation.  Alternatives:</p>
<ol class="arabic">
<li><p class="first">This format is the most natural and obvious.  It was independently
invented (no great feat of creation!), and later found to be the
format supported by the <a class="reference external" href="http://table.sourceforge.net/">Emacs table mode</a>:</p>
<div class="highlight-python"><pre>+------------+------------+------------+--------------+
|  Header 1  |  Header 2  |  Header 3  |  Header 4    |
+============+============+============+==============+
|  Column 1  |  Column 2  | Column 3 &amp; 4 span (Row 1) |
+------------+------------+------------+--------------+
|    Column 1 &amp; 2 span    |  Column 3  | - Column 4   |
+------------+------------+------------+ - Row 2 &amp; 3  |
|      1     |      2     |      3     | - span       |
+------------+------------+------------+--------------+</pre>
</div>
<p>Tables are described with a visual outline made up of the
characters &#8216;-&#8216;, &#8216;=&#8217;, &#8216;|&#8217;, and &#8216;+&#8217;:</p>
<ul class="simple">
<li>The hyphen (&#8216;-&#8216;) is used for horizontal lines (row separators).</li>
<li>The equals sign (&#8216;=&#8217;) is optionally used as a header separator
(as of version 1.5.24, this is not supported by the Emacs table
mode).</li>
<li>The vertical bar (&#8216;|&#8217;) is used for for vertical lines (column
separators).</li>
<li>The plus sign (&#8216;+&#8217;) is used for intersections of horizontal and
vertical lines.</li>
</ul>
<p>Row and column spans are possible simply by omitting the column or
row separators, respectively.  The header row separator must be
complete; in other words, a header cell may not span into the table
body.  Each cell contains body elements, and may have multiple
paragraphs, lists, etc.  Initial spaces for a left margin are
allowed; the first line of text in a cell determines its left
margin.</p>
</li>
<li><p class="first">Below is a simpler table structure.  It may be better suited to
manual input than alternative #1, but there is no Emacs editing
mode available.  One disadvantage is that it resembles section
titles; a one-column table would look exactly like section &amp;
subsection titles.</p>
<div class="highlight-python"><pre>============ ============ ============ ==============
  Header 1     Header 2     Header 3     Header 4
============ ============ ============ ==============
  Column 1     Column 2    Column 3 &amp; 4 span (Row 1)
------------ ------------ ---------------------------
    Column 1 &amp; 2 span       Column 3    - Column 4
------------------------- ------------  - Row 2 &amp; 3
      1            2            3       - span
============ ============ ============ ==============</pre>
</div>
<p>The table begins with a top border of equals signs with a space at
each column boundary (regardless of spans).  Each row is
underlined.  Internal row separators are underlines of &#8216;-&#8216;, with
spaces at column boundaries.  The last of the optional head rows is
underlined with &#8216;=&#8217;, again with spaces at column boundaries.
Column spans have no spaces in their underline.  Row spans simply
lack an underline at the row boundary.  The bottom boundary of the
table consists of &#8216;=&#8217; underlines.  A blank line is required
following a table.</p>
</li>
<li><p class="first">A minimalist alternative is as follows:</p>
<div class="highlight-python"><pre>====  =====  ========  ========  =======  ====  =====  =====
Old State    Input     Action             New State    Notes
-----------  --------  -----------------  -----------
ids   types  new type  sys.msg.  dupname  ids   types
====  =====  ========  ========  =======  ====  =====  =====
--    --     explicit  --        --       new   True
--    --     implicit  --        --       new   False
None  False  explicit  --        --       new   True
old   False  explicit  implicit  old      new   True
None  True   explicit  explicit  new      None  True
old   True   explicit  explicit  new,old  None  True   [1]
None  False  implicit  implicit  new      None  False
old   False  implicit  implicit  new,old  None  False
None  True   implicit  implicit  new      None  True
old   True   implicit  implicit  new      old   True
====  =====  ========  ========  =======  ====  =====  =====</pre>
</div>
<p>The table begins with a top border of equals signs with one or more
spaces at each column boundary (regardless of spans).  There must
be at least two columns in the table (to differentiate it from
section headers).  Each line starts a new row.  The rightmost
column is unbounded; text may continue past the edge of the table.
Each row/line must contain spaces at column boundaries, except for
explicit column spans.  Underlines of &#8216;-&#8216; can be used to indicate
column spans, but should be used sparingly if at all.  Lines
containing column span underlines may not contain any other text.
The last of the optional head rows is underlined with &#8216;=&#8217;, again
with spaces at column boundaries.  The bottom boundary of the table
consists of &#8216;=&#8217; underlines.  A blank line is required following a
table.</p>
<p>This table sums up the features.  Using all the features in such a
small space is not pretty though:</p>
<div class="highlight-python"><pre>========  ========  ========
          Header 2 &amp; 3 Span
          ------------------
Header 1  Header 2  Header 3
========  ========  ========
Each      line is   a new row.
Each row  consists  of one line only.
Row       spans     are not possible.
The last  column    may spill over to the right.
Column spans are possible with an underline joining columns.
----------------------------
The span  is        limited to the row above the underline.
========  ========  ========</pre>
</div>
</li>
<li><p class="first">As a variation of alternative 3, bullet list syntax in the first
column could be used to indicate row starts.  Multi-line rows are
possible, but row spans are not.  For example:</p>
<div class="highlight-python"><pre>===== =====
col 1 col 2
===== =====
- 1   Second column of row 1.
- 2   Second column of row 2.
      Second line of paragraph.
- 3   Second column of row 3.

      Second paragraph of row 3,
      column 2
===== =====</pre>
</div>
<p>Column spans would be indicated on the line after the last line of
the row.  To indicate a real bullet list within a first-column
cell, simply nest the bullets.</p>
</li>
<li><p class="first">In a further variation, we could simply assume that whitespace in
the first column implies a multi-line row; the text in other
columns is continuation text.  For example:</p>
<div class="highlight-python"><pre>===== =====
col 1 col 2
===== =====
1     Second column of row 1.
2     Second column of row 2.
      Second line of paragraph.
3     Second column of row 3.

      Second paragraph of row 3,
      column 2
===== =====</pre>
</div>
<p>Limitations of this approach:</p>
<ul class="simple">
<li>Cells in the first column are limited to one line of text.</li>
<li>Cells in the first column <em>must</em> contain some text; blank cells
would lead to a misinterpretation.  An empty comment (&#8221;..&#8221;) is
sufficient.</li>
</ul>
</li>
<li><p class="first">Combining alternative 3 and 4, a bullet list in the first column
could mean multi-line rows, and no bullet list means single-line
rows only.</p>
</li>
</ol>
<p>Alternatives 1 and 5 has been adopted by reStructuredText.</p>
</div>
<div class="section" id="delimitation-of-inline-markup">
<h2><a class="toc-backref" href="#id14">Delimitation of Inline Markup</a><a class="headerlink" href="#delimitation-of-inline-markup" title="Permalink to this headline">¶</a></h2>
<p>StructuredText specifies that inline markup must begin with
whitespace, precluding such constructs as parenthesized or quoted
emphatic text:</p>
<div class="highlight-python"><pre>"**What?**" she cried.  (*exit stage left*)</pre>
</div>
<p>The <a class="reference external" href="../../ref/rst/restructuredtext.html">reStructuredText markup specification</a> allows for such
constructs and disambiguates inline markup through a set of
recognition rules.  These recognition rules define the context of
markup start-strings and end-strings, allowing markup characters to be
used in most non-markup contexts without a problem (or a backslash).
So we can say, &#8220;Use asterisks (*) around words or phrases to
<em>emphasisze</em> them.&#8221; The &#8216;(*)&#8217; will not be recognized as markup.  This
reduces the need for markup escaping to the point where an escape
character is <em>almost</em> (but not quite!) unnecessary.</p>
</div>
<div class="section" id="underlining">
<h2><a class="toc-backref" href="#id15">Underlining</a><a class="headerlink" href="#underlining" title="Permalink to this headline">¶</a></h2>
<p>StructuredText uses &#8216;_text_&#8217; to indicate underlining.  To quote David
Ascher in his 2000-01-21 Doc-SIG mailing list post, &#8220;Docstring
grammar: a very revised proposal&#8221;:</p>
<blockquote>
<div>The tagging of underlined text with _&#8217;s is suboptimal.  Underlines
shouldn&#8217;t be used from a typographic perspective (underlines were
designed to be used in manuscripts to communicate to the
typesetter that the text should be italicized &#8211; no well-typeset
book ever uses underlines), and conflict with double-underscored
Python variable names (__init__ and the like), which would get
truncated and underlined when that effect is not desired.  Note
that while <em>complete</em> markup would prevent that truncation
(&#8216;__init__&#8217;), I think of docstring markups much like I think of
type annotations &#8211; they should be optional and above all do no
harm.  In this case the underline markup does harm.</div></blockquote>
<p>Underlining is not part of the reStructuredText specification.</p>
</div>
<div class="section" id="inline-literals">
<h2><a class="toc-backref" href="#id16">Inline Literals</a><a class="headerlink" href="#inline-literals" title="Permalink to this headline">¶</a></h2>
<p>StructuredText&#8217;s markup for inline literals (text left as-is,
verbatim, usually in a monospaced font; as in HTML &lt;TT&gt;) is single
quotes (&#8216;literals&#8217;).  The problem with single quotes is that they are
too often used for other purposes:</p>
<ul>
<li><p class="first">Apostrophes: &#8220;Don&#8217;t blame me, &#8216;cause it ain&#8217;t mine, it&#8217;s Chris&#8217;.&#8221;;</p>
</li>
<li><p class="first">Quoting text:</p>
<blockquote>
<div><p>First Bruce: &#8220;Well Bruce, I heard the prime minister use it.
&#8216;S&#8217;hot enough to boil a monkey&#8217;s bum in &#8216;ere your Majesty,&#8217; he
said, and she smiled quietly to herself.&#8221;</p>
</div></blockquote>
<p>In the UK, single quotes are used for dialogue in published works.</p>
</li>
<li><p class="first">String literals: s = &#8216;&#8217;</p>
</li>
</ul>
<p>Alternatives:</p>
<div class="highlight-python"><pre>'text'    \'text\'    ''text''    "text"    \"text\"    ""text""
#text#     @text@      `text`     ^text^    ``text''    ``text``</pre>
</div>
<p>The examples below contain inline literals, quoted text, and
apostrophes.  Each example should evaluate to the following HTML:</p>
<div class="highlight-python"><pre>Some &lt;TT&gt;code&lt;/TT&gt;, with a 'quote', "double", ain't it grand?
Does &lt;TT&gt;a[b] = 'c' + "d" + `2^3`&lt;/TT&gt; work?

0. Some code, with a quote, double, ain't it grand?
   Does a[b] = 'c' + "d" + `2^3` work?
1. Some 'code', with a \'quote\', "double", ain\'t it grand?
   Does 'a[b] = \'c\' + "d" + `2^3`' work?
2. Some \'code\', with a 'quote', "double", ain't it grand?
   Does \'a[b] = 'c' + "d" + `2^3`\' work?
3. Some ''code'', with a 'quote', "double", ain't it grand?
   Does ''a[b] = 'c' + "d" + `2^3`'' work?
4. Some "code", with a 'quote', \"double\", ain't it grand?
   Does "a[b] = 'c' + "d" + `2^3`" work?
5. Some \"code\", with a 'quote', "double", ain't it grand?
   Does \"a[b] = 'c' + "d" + `2^3`\" work?
6. Some ""code"", with a 'quote', "double", ain't it grand?
   Does ""a[b] = 'c' + "d" + `2^3`"" work?
7. Some #code#, with a 'quote', "double", ain't it grand?
   Does #a[b] = 'c' + "d" + `2^3`# work?
8. Some @code@, with a 'quote', "double", ain't it grand?
   Does @a[b] = 'c' + "d" + `2^3`@ work?
9. Some `code`, with a 'quote', "double", ain't it grand?
   Does `a[b] = 'c' + "d" + \`2^3\`` work?
10. Some ^code^, with a 'quote', "double", ain't it grand?
    Does ^a[b] = 'c' + "d" + `2\^3`^ work?
11. Some ``code'', with a 'quote', "double", ain't it grand?
    Does ``a[b] = 'c' + "d" + `2^3`'' work?
12. Some ``code``, with a 'quote', "double", ain't it grand?
    Does ``a[b] = 'c' + "d" + `2^3\``` work?</pre>
</div>
<p>Backquotes (#9 &amp; #12) are the best choice.  They are unobtrusive and
relatviely rarely used (more rarely than &#8216; or &#8221;, anyhow).  Backquotes
have the connotation of &#8216;quotes&#8217;, which other options (like carets,
#10) don&#8217;t.</p>
<p>Analogously with <tt class="docutils literal"><span class="pre">*emph*</span></tt> &amp; <tt class="docutils literal"><span class="pre">**strong**</span></tt>, double-backquotes (#12)
could be used for inline literals.  If single-backquotes are used for
&#8216;interpreted text&#8217; (context-sensitive domain-specific descriptive
markup) such as function name hyperlinks in Python docstrings, then
double-backquotes could be used for absolute-literals, wherein no
processing whatsoever takes place.  An advantage of double-backquotes
would be that backslash-escaping would no longer be necessary for
embedded single-backquotes; however, embedded double-backquotes (in an
end-string context) would be illegal.  See <a class="reference external" href="alternatives.html#backquotes-in-phrase-links">Backquotes in
Phrase-Links</a> in <a class="reference external" href="alternatives.html">Record of reStructuredText Syntax Alternatives</a>.</p>
<p>Alternative choices are carets (#10) and TeX-style quotes (#11).  For
examples of TeX-style quoting, see
<a class="reference external" href="http://www.zope.org/Members/jim/StructuredTextWiki/CustomizingTheDocumentProcessor">http://www.zope.org/Members/jim/StructuredTextWiki/CustomizingTheDocumentProcessor</a>.</p>
<p>Some existing uses of backquotes:</p>
<ol class="arabic simple">
<li>As a synonym for repr() in Python.</li>
<li>For command-interpolation in shell scripts.</li>
<li>Used as open-quotes in TeX code (and carried over into plaintext
by TeXies).</li>
</ol>
<p>The inline markup start-string and end-string recognition rules
defined by the <a class="reference external" href="../../ref/rst/restructuredtext.html">reStructuredText markup specification</a> would allow
all of these cases inside inline literals, with very few exceptions.
As a fallback, literal blocks could handle all cases.</p>
<p>Outside of inline literals, the above uses of backquotes would require
backslash-escaping.  However, these are all prime examples of text
that should be marked up with inline literals.</p>
<p>If either backquotes or straight single-quotes are used as markup,
TeX-quotes are too troublesome to support, so no special-casing of
TeX-quotes should be done (at least at first).  If TeX-quotes have to
be used outside of literals, a single backslash-escaped would suffice:
``TeX quote&#8217;&#8216;.  Ugly, true, but very infrequently used.</p>
<p>Using literal blocks is a fallback option which removes the need for
backslash-escaping:</p>
<div class="highlight-python"><pre>like this::

    Here, we can do ``absolutely'' anything `'`'\|/|\ we like!</pre>
</div>
<p>No mechanism for inline literals is perfect, just as no escaping
mechanism is perfect.  No matter what we use, complicated inline
expressions involving the inline literal quote and/or the backslash
will end up looking ugly.  We can only choose the least often ugly
option.</p>
<p>reStructuredText will use double backquotes for inline literals, and
single backqoutes for interpreted text.</p>
</div>
<div class="section" id="hyperlinks">
<h2><a class="toc-backref" href="#id17">Hyperlinks</a><a class="headerlink" href="#hyperlinks" title="Permalink to this headline">¶</a></h2>
<p>There are three forms of hyperlink currently in <a class="reference external" href="http://www.zope.org/DevHome/Members/jim/StructuredTextWiki/FrontPage">StructuredText</a>:</p>
<ol class="arabic">
<li><p class="first">(Absolute &amp; relative URIs.)  Text enclosed by double quotes
followed by a colon, a URI, and concluded by punctuation plus white
space, or just white space, is treated as a hyperlink:</p>
<div class="highlight-python"><pre>"Python":http://www.python.org/</pre>
</div>
</li>
<li><p class="first">(Absolute URIs only.)  Text enclosed by double quotes followed by a
comma, one or more spaces, an absolute URI and concluded by
punctuation plus white space, or just white space, is treated as a
hyperlink:</p>
<div class="highlight-python"><pre>"mail me", mailto:me@mail.com</pre>
</div>
</li>
<li><p class="first">(Endnotes.)  Text enclosed by brackets link to an endnote at the
end of the document: at the beginning of the line, two dots, a
space, and the same text in brackets, followed by the end note
itself:</p>
<div class="highlight-python"><pre>Please refer to the fine manual [GVR2001].

.. [GVR2001] Python Documentation, Release 2.1, van Rossum,
   Drake, et al., http://www.python.org/doc/</pre>
</div>
</li>
</ol>
<p>The problem with forms 1 and 2 is that they are neither intuitive nor
unobtrusive (they break design goals 5 &amp; 2).  They overload
double-quotes, which are too often used in ordinary text (potentially
breaking design goal 4).  The brackets in form 3 are also too common
in ordinary text (such as [nested] asides and Python lists like [12]).</p>
<p>Alternatives:</p>
<ol class="arabic">
<li><p class="first">Have no special markup for hyperlinks.</p>
</li>
<li><ol class="first upperalpha">
<li><p class="first">Interpret and mark up hyperlinks as any contiguous text
containing &#8216;://&#8217; or &#8216;:...&#64;&#8217; (absolute URI) or &#8216;&#64;&#8217; (email
address) after an alphanumeric word.  To de-emphasize the URI,
simply enclose it in parentheses:</p>
<blockquote>
<div><p>Python (<a class="reference external" href="http://www.python.org/">http://www.python.org/</a>)</p>
</div></blockquote>
</li>
<li><p class="first">Leave special hyperlink markup as a domain-specific extension.
Hyperlinks in ordinary reStructuredText documents would be
required to be standalone (i.e. the URI text inline in the
document text).  Processed hyperlinks (where the URI text is
hidden behind the link) are important enough to warrant syntax.</p>
</li>
</ol>
</li>
<li><p class="first">The original <a class="reference external" href="http://docutils.sourceforge.net/mirror/setext.html">Setext</a> introduced a mechanism of indirect hyperlinks.
A source link word (&#8216;hot word&#8217;) in the text was given a trailing
underscore:</p>
<div class="highlight-python"><pre>Here is some text with a hyperlink_ built in.</pre>
</div>
<p>The hyperlink itself appeared at the end of the document on a line
by itself, beginning with two dots, a space, the link word with a
leading underscore, whitespace, and the URI itself:</p>
<div class="highlight-python"><pre>.. _hyperlink http://www.123.xyz</pre>
</div>
<p>Setext used <tt class="docutils literal"><span class="pre">underscores_instead_of_spaces_</span></tt> for phrase links.</p>
</li>
</ol>
<p>With some modification, alternative 3 best satisfies the design goals.
It has the advantage of being readable and relatively unobtrusive.
Since each source link must match up to a target, the odd variable
ending in an underscore can be spared being marked up (although it
should generate a &#8220;no such link target&#8221; warning).  The only
disadvantage is that phrase-links aren&#8217;t possible without some
obtrusive syntax.</p>
<p>We could achieve phrase-links if we enclose the link text:</p>
<ol class="arabic">
<li><p class="first">in double quotes:</p>
<div class="highlight-python"><pre>"like this"_</pre>
</div>
</li>
<li><p class="first">in brackets:</p>
<div class="highlight-python"><pre>[like this]_</pre>
</div>
</li>
<li><p class="first">or in backquotes:</p>
<div class="highlight-python"><pre>`like this`_</pre>
</div>
</li>
</ol>
<p>Each gives us somewhat obtrusive markup, but that is unavoidable.  The
bracketed syntax (#2) is reminiscent of links on many web pages
(intuitive), although it is somewhat obtrusive.  Alternative #3 is
much less obtrusive, and is consistent with interpreted text: the
trailing underscore indicates the interpretation of the phrase, as a
hyperlink.  #3 also disambiguates hyperlinks from footnote references.
Alternative #3 wins.</p>
<p>The same trailing underscore markup can also be used for footnote and
citation references, removing the problem with ordinary bracketed text
and Python lists:</p>
<div class="highlight-python"><pre>Please refer to the fine manual [GVR2000]_.

.. [GVR2000] Python Documentation, van Rossum, Drake, et al.,
   http://www.python.org/doc/</pre>
</div>
<p>The two-dots-and-a-space syntax was generalized by Setext for
comments, which are removed from the (visible) processed output.
reStructuredText uses this syntax for comments, footnotes, and link
target, collectively termed &#8220;explicit markup&#8221;.  For link targets, in
order to eliminate ambiguity with comments and footnotes,
reStructuredText specifies that a colon always follow the link target
word/phrase.  The colon denotes &#8216;maps to&#8217;.  There is no reason to
restrict target links to the end of the document; they could just as
easily be interspersed.</p>
<p>Internal hyperlinks (links from one point to another within a single
document) can be expressed by a source link as before, and a target
link with a colon but no URI.  In effect, these targets &#8216;map to&#8217; the
element immediately following.</p>
<p>As an added bonus, we now have a perfect candidate for
reStructuredText directives, a simple extension mechanism: explicit
markup containing a single word followed by two colons and whitespace.
The interpretation of subsequent data on the directive line or
following is directive-dependent.</p>
<p>To summarize:</p>
<div class="highlight-python"><pre>.. This is a comment.

.. The line below is an example of a directive.
.. version:: 1

This is a footnote [1]_.

This internal hyperlink will take us to the footnotes_ area below.

Here is a one-word_ external hyperlink.

Here is `a hyperlink phrase`_.

.. _footnotes:
.. [1] Footnote text goes here.

.. external hyperlink target mappings:
.. _one-word: http://www.123.xyz
.. _a hyperlink phrase: http://www.123.xyz</pre>
</div>
<p>The presence or absence of a colon after the target link
differentiates an indirect hyperlink from a footnote, respectively.  A
footnote requires brackets.  Backquotes around a target link word or
phrase are required if the phrase contains a colon, optional
otherwise.</p>
<p>Below are examples using no markup, the two StructuredText hypertext
styles, and the reStructuredText hypertext style.  Each example
contains an indirect link, a direct link, a footnote/endnote, and
bracketed text.  In HTML, each example should evaluate to:</p>
<div class="highlight-python"><pre>&lt;P&gt;A &lt;A HREF="http://spam.org"&gt;URI&lt;/A&gt;, see &lt;A HREF="#eggs2000"&gt;
[eggs2000]&lt;/A&gt; (in Bacon [Publisher]).  Also see
&lt;A HREF="http://eggs.org"&gt;http://eggs.org&lt;/A&gt;.&lt;/P&gt;

&lt;P&gt;&lt;A NAME="eggs2000"&gt;[eggs2000]&lt;/A&gt; "Spam, Spam, Spam, Eggs,
Bacon, and Spam"&lt;/P&gt;</pre>
</div>
<ol class="arabic">
<li><p class="first">No markup:</p>
<div class="highlight-python"><pre>A URI http://spam.org, see eggs2000 (in Bacon [Publisher]).
Also see http://eggs.org.

eggs2000 "Spam, Spam, Spam, Eggs, Bacon, and Spam"</pre>
</div>
</li>
<li><p class="first">StructuredText absolute/relative URI syntax
(&#8220;text&#8221;:<a class="reference external" href="http://www.url.org">http://www.url.org</a>):</p>
<div class="highlight-python"><pre>A "URI":http://spam.org, see [eggs2000] (in Bacon [Publisher]).
Also see "http://eggs.org":http://eggs.org.

.. [eggs2000] "Spam, Spam, Spam, Eggs, Bacon, and Spam"</pre>
</div>
<p>Note that StructuredText does not recognize standalone URIs,
forcing doubling up as shown in the second line of the example
above.</p>
</li>
<li><p class="first">StructuredText absolute-only URI syntax
(&#8220;text&#8221;, <a class="reference external" href="mailto:you&#37;&#52;&#48;your&#46;com">mailto:you<span>&#64;</span>your<span>&#46;</span>com</a>):</p>
<div class="highlight-python"><pre>A "URI", http://spam.org, see [eggs2000] (in Bacon
[Publisher]).  Also see "http://eggs.org", http://eggs.org.

.. [eggs2000] "Spam, Spam, Spam, Eggs, Bacon, and Spam"</pre>
</div>
</li>
<li><p class="first">reStructuredText syntax:</p>
<div class="highlight-python"><pre>4. A URI_, see [eggs2000]_ (in Bacon [Publisher]).
   Also see http://eggs.org.

   .. _URI: http:/spam.org
   .. [eggs2000] "Spam, Spam, Spam, Eggs, Bacon, and Spam"</pre>
</div>
</li>
</ol>
<p>The bracketed text &#8216;[Publisher]&#8217; may be problematic with
StructuredText (syntax 2 &amp; 3).</p>
<p>reStructuredText&#8217;s syntax (#4) is definitely the most readable.  The
text is separated from the link URI and the footnote, resulting in
cleanly readable text.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Problems With StructuredText</a><ul>
<li><a class="reference internal" href="#formal-specification">Formal Specification</a></li>
<li><a class="reference internal" href="#understanding-and-extending-the-code">Understanding and Extending the Code</a></li>
<li><a class="reference internal" href="#section-structure-via-indentation">Section Structure via Indentation</a></li>
<li><a class="reference internal" href="#character-escaping-mechanism">Character Escaping Mechanism</a></li>
<li><a class="reference internal" href="#blank-lines-in-lists">Blank Lines in Lists</a></li>
<li><a class="reference internal" href="#bullet-list-markup">Bullet List Markup</a></li>
<li><a class="reference internal" href="#enumerated-list-markup">Enumerated List Markup</a></li>
<li><a class="reference internal" href="#definition-list-markup">Definition List Markup</a></li>
<li><a class="reference internal" href="#literal-blocks">Literal Blocks</a></li>
<li><a class="reference internal" href="#tables">Tables</a></li>
<li><a class="reference internal" href="#delimitation-of-inline-markup">Delimitation of Inline Markup</a></li>
<li><a class="reference internal" href="#underlining">Underlining</a></li>
<li><a class="reference internal" href="#inline-literals">Inline Literals</a></li>
<li><a class="reference internal" href="#hyperlinks">Hyperlinks</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../../_sources/docs/dev/rst/problems.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li><a href="../../../index.html">klb3713&#39;s notebook</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, klb3713.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>